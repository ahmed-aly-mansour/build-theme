
{{ 'swiper7.4.1.min.css' | asset_url | stylesheet_tag }}
{{ 'section-columns-carousel.css' | asset_url | stylesheet_tag }}
<script src="{{ "swiper7.4.1.min.js" | asset_url }}" defer="defer" id="swiper-script"></script>
<script src="{{ 'component-columns-carousel-slider.js' | asset_url }}" defer="defer"></script>


{%  liquid
    assign heading = section.settings.heading
    assign subheading = section.settings.subheading
    assign carousels_to_show = section.blocks.size
    assign heading_alignment = section.settings.heading_alignment
%}

<style>
    .carousel-block{
        --base-width: {{ 100 | divided_by: carousels_to_show }}%;
        --margin-r-value: 48px;
    }
</style>

<columns-carousel data-section-id="{{ section.id }}" class="columns-carousel-section" style="position: relative;">
    
    <div class="columns-carousel__header title-wrapper title-wrapper--no-top-margin page-width" style="text-align: {{ heading_alignment }};">
        {%- if heading != blank -%}
        <h2 class="columns-carousel__heading title h2">{{ heading | escape }}</h2>
        {%- endif -%}
        {%- if subheading != blank -%}
        <p class="columns-carousel__subheading subtitle">{{ subheading | escape }}</p>
        {%- endif -%}
    </div>

    <div class="columns-carousel-content swiper" id="columns-carousel-{{ section.id }}" style="background-color: {{ section.settings.carousel_bg_color }}">
        <!-- Additional required wrapper -->
        <div class="columns-carousel-content-wrapper swiper-wrapper">
            <!-- Slides -->
            {% for block in section.blocks %}
                {% assign card_image = block.settings.card_image %}
                {% assign card_title = block.settings.card_title %}
                {% assign card_description = block.settings.card_description %}
                {% assign show_learn_more = block.settings.learn_more_button %}

                <div class="carousel-block swiper-slide">
                    <div class="carousel-block-image-container" style="padding-top: {{ carousels_to_show | times: 30 }}%">
                        <img 
                            src="{{ card_image | image_url: width: 500 }}" 
                            alt="{{ card_image.alt | escape}}"
                            width="{{ card_image.width }}"
                            height="{{ card_image.height }}"
                            class="carousel-block__image"
                        >
                    </div>

                    <div class="carousel-block-content-container">
                        <h3 class="carousel-block-content__heading">{{ card_title }}</h3>
                        <div class="carousel-block-content__desc">
                            <p>{{ card_description }}</p>
                        </div>
                        {% if show_learn_more %}
                            <a 
                                href="{{ block.settings.learn_more_button_link | default: '#' }}"
                                class="carousel-block-content__button"
                            >{{ block.settings.learn_more_button_text }}</a>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
            
        </div>
        <!-- If we need pagination -->
        <div class="swiper-pagination"></div>

        <!-- If we need navigation buttons -->
        <div class="swiper-button-prev">
            <button><</button>
        </div>
        <div class="swiper-button-next">
            <button>></button>
        </div>

    </div>
</columns-carousel>


{% schema %}
    {
        "name": "Columns Carousel",
        "tag": "section",
        "class": "columns-carousel",
        "settings": [
            {
            "type": "text",
            "id": "heading",
            "label": "Heading"
            },
            {
            "type": "text",
            "id": "subheading",
            "label": "Subheading"
            },
            {
                "type": "color",
                "id": "carousel_bg_color",
                "label" : "Carousel Background Color"
            }
        ],
        "blocks": [
            {
                "type" : "column-card",
                "name" : "Column Card",
                "limit": 4,
                "settings" : 
                [
                    {
                        "type": "image_picker",
                        "id": "card_image",
                        "label": "Card Image"
                    },
                    {
                        "type": "text",
                        "id": "card_title",
                        "label": "Card Title"
                    },
                    {
                        "type": "text",
                        "id": "card_description",
                        "label": "Card Description"
                    },
                    {
                        "type": "checkbox",
                        "id": "learn_more_button",
                        "label": "Show Card Learn More link"
                    },
                    {
                        "type": "url",
                        "id": "learn_more_button_link",
                        "label": "Learn More Link"
                    },
                    {
                        "type": "text",
                        "id": "learn_more_button_text",
                        "label": "Learn More text",
                        "default": "Learn More"
                    }
                ]
            }
        ],
        "presets": [
            {
                "name" : "Columns Carousel",
                "blocks": [
                    {"type": "column-card"}
                ]
            }
        ]
    }
{% endschema %}